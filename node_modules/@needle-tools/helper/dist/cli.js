#!/usr/bin/env node
import caporal from '@caporal/core';
import { readFileSync } from 'fs';
import { share } from './actions/share.js';
const program = caporal.program;
const PACKAGE = JSON.parse(readFileSync(new URL('../package.json', import.meta.url), 'utf-8'));
program.version(PACKAGE.version).description('Command-line interface (CLI) for the Needle Helper');
program.command('', '\n\nDeployment ──────────────────────────────────────────');
program
    .command('share', 'Needle Share')
    .help(``.trim())
    .argument('<id>', 'The id of your shared project', { validator: program.STRING })
    .argument('<directory>', 'The directory to share', { validator: program.STRING })
    .option('--access-token <access-token>', 'The access token to use', { validator: program.STRING })
    .option('--endpoint <endpoint>', 'The endpoint to share to', { validator: program.STRING })
    .option('--open', 'Open the share in the browser', { default: true, validator: program.BOOLEAN })
    .action(async ({ args, options, logger }) => {
    console.log("Sharing...\n", options, "\n", args);
    await share({
        id: args.id,
        assetsDirectory: args.directory,
        storageUrl: args.endpoint,
        access_token: options.accessToken,
        open: options.open
    });
});
program.run();
